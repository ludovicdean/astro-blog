---
import {getCollection} from "astro:content";

const posts = await getCollection("blog");
const base = import.meta.env.BASE_URL;
let cloud = {};
function slugify(str) {
    return String(str)
        .normalize("NFKD")
        .replace(/[\u0300-\u036f]/g, "")
        .trim()
        .toLowerCase()
        .replace(/[^a-z0-9 -]/g, "")
        .replace(/\s+/g, "-")
        .replace(/-+/g, "-");
}

posts.forEach((post) => {
  post.data.tags.forEach((tag) => {
    if (!cloud[tag]) cloud[tag] = 0;
    cloud[tag] += 1;
    });
    });

let tags = [];

for (let prop in cloud) {
    tags.push(prop);
    }

tags.sort(function (a, b) {
    if (a < b) {
        return -1;
    }
    if (a > b) {
        return 1;
    }
    return 0;
});

---
<div class="text-center my-5">
    {tags.map(tag => (
            <a href={`${base + "/tags/" + slugify(tag)}/`}>
                <span class="mx-2" style={`font-size:${cloud[tag]*3+12}px;`}>{tag}</span>
            </a>
    ))}
</div>